(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{263:function(e,t,a){e.exports=a(264)},264:function(e,t,a){"use strict";a.r(t);var n=a(5),i=a(6),o=a(18),c=a(12),r=a(13),s=a(17),d=a(37),l=a(40),h=a.n(l),u=a(240),m=a.n(u),v=a(241),f=a.n(v),p=(a(286),a(309)),g={"Content-Type":"application/json"},b=["Calculator","Cup","Ear_Piece","GoogleGlass","Head_Phone","Laptop","MobilePhone","Notebook","Pen","Smart_watch","Spec","SunGlass"],w=640,x=640,y=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(o.a)(this,Object(c.a)(t).call(this,e))).videoRef=h.a.createRef(),a.canvasRef=h.a.createRef(),a.state={model:null,preview:"",userid:"",proctorid:"",examid:"",predictions:[]},a.pushToDynamodb=function(e){var t={id:"".concat(a.state.userid,"_").concat(a.state.examid),eid:a.state.examid,cid:a.state.userid,ts:e.timestamp,pid:a.state.proctorid,predict:JSON.stringify(e)};f.a.post("https://sh3x2x9en3.execute-api.us-east-1.amazonaws.com/test/",t,{headers:g}).then(function(e){}).catch(function(e){})},a.checkwithVideo=function(){var e;void 0===e&&(e=setInterval(function(){a.onImageChange()},100))},a.cropToCanvas=function(e,t,n){var i=e.videoWidth,o=e.videoHeight;n.clearRect(0,0,n.canvas.width,n.canvas.height),n.fillStyle="#000000",n.fillRect(0,0,t.width,t.height);var c=Math.min(t.width/e.videoWidth,t.height/e.videoHeight),r=Math.round(i*c),s=Math.round(o*c);n.drawImage(a.videoRef.current,0,0,i,o,(t.width-r)/2,(t.height-s)/2,r,s)},a.onImageChange=function(){var e=a.canvasRef.current,t=e.getContext("2d");t.clearRect(0,0,t.canvas.width,t.canvas.height);var i=p.tidy(function(){return p.image.resizeBilinear(p.browser.fromPixels(a.videoRef.current),[w,x]).div(255).expandDims(0)});a.state.model.executeAsync(i).then(function(o){var c={detection:[],timestamp:""},r="16px sans-serif";t.font=r,t.textBaseline="top";var s,d=Object(n.a)(o,4),l=d[0],h=d[1],u=d[2],m=d[3],v=l.dataSync(),f=h.dataSync(),g=u.dataSync(),w=m.dataSync()[0];for(p.dispose(o),p.dispose(i),s=0;s<w;++s){var x=v.slice(4*s,4*(s+1)),y=Object(n.a)(x,4),E=y[0],C=y[1],S=y[2],j=y[3];E*=e.width,S*=e.width,C*=e.height;var O=S-E,D=(j*=e.height)-C,I=b[g[s]],R=f[s].toFixed(2);t.strokeStyle="#00FFFF",t.lineWidth=4,t.strokeRect(E,C,O,D),t.fillStyle="#00FFFF";var k=t.measureText(I+":"+R).width,F=parseInt(r,10);t.fillRect(E,C,k+4,F+4)}for(s=0;s<w;++s){var P=v.slice(4*s,4*(s+1)),M=Object(n.a)(P,3),T=M[0],_=M[1];T*=e.width,_*=e.height;var G=b[g[s]],z=f[s].toFixed(2);c.detection.push({class:G,score:z}),t.fillStyle="#000000",t.fillText(G+":"+z,T,_)}c.timestamp=Date.now(),c.detection&&c.detection.length>0&&a.pushToDynamodb(c)})},a.state={model:null,preview:"",userid:"",proctorid:"",examid:"",predictions:[]},a.handleSubmit=a.handleSubmit.bind(Object(d.a)(Object(d.a)(a))),a.handleuserChange=a.handleuserChange.bind(Object(d.a)(Object(d.a)(a))),a.handleExamChange=a.handleExamChange.bind(Object(d.a)(Object(d.a)(a))),a.handleproctorChange=a.handleproctorChange.bind(Object(d.a)(Object(d.a)(a))),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){}}]),Object(r.a)(t,[{key:"startcamera",value:function(){var e=this;if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia){var t=navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:"user"}}).then(function(t){return window.stream=t,e.videoRef.current.srcObject=t,new Promise(function(t,a){e.videoRef.current.onloadedmetadata=function(){t()}})}),a=p.loadGraphModel("/web_model_old/model.json").then(function(t){return e.setState({model:t}),console.log("model ready......",t),e.state.model});Promise.all([a,t]).then(function(t){e.checkwithVideo()}).catch(function(e){console.error(e)})}}},{key:"handleuserChange",value:function(e){this.setState({userid:e.target.value})}},{key:"handleExamChange",value:function(e){this.setState({examid:e.target.value})}},{key:"handleproctorChange",value:function(e){this.setState({proctorid:e.target.value})}},{key:"handleSubmit",value:function(e){e.preventDefault(),""!==this.state.userid&&""!==this.state.examid&&""!==this.state.proctorid&&this.startcamera()}},{key:"render",value:function(){return h.a.createElement("div",{class:"row "},h.a.createElement("div",{class:"col-md-2"},h.a.createElement("h1",{class:"heading"},"Object Detection "),h.a.createElement("form",{class:"p-2",onSubmit:this.handleSubmit},h.a.createElement("div",{class:"form-group mar"},h.a.createElement("label",{for:"candiadteID"},"Candidate ID:"),h.a.createElement("input",{type:"text",class:"form-control",id:"candiadateId",value:this.state.userid,placeholder:"enter candidateId",onChange:this.handleuserChange})),h.a.createElement("div",{class:"form-group  mar"},h.a.createElement("label",{for:"examID"},"Exam ID:"),h.a.createElement("input",{type:"text",class:"form-control",value:this.state.examid,onChange:this.handleExamChange,placeholder:"enter examID"})),h.a.createElement("div",{class:"form-group  mar"},h.a.createElement("label",{for:"proctorID"},"Proctor ID:"),h.a.createElement("input",{type:"text",class:"form-control",value:this.state.proctorid,onChange:this.handleproctorChange,placeholder:"enter proctorID"})),h.a.createElement("input",{type:"submit",class:"btn button-width text-white",value:"Submit"}))),h.a.createElement("div",{class:"col-md-5 style1"},h.a.createElement("video",{class:"test",autoPlay:!0,style:{visibility:""},muted:!0,ref:this.videoRef,width:"500",height:"800px"})),h.a.createElement("div",{class:"col-md-5 canva"},h.a.createElement("h1",{class:"heading"},"Proctor View "),h.a.createElement("canvas",{className:"size",ref:this.canvasRef,style:{visibility:""},width:"500",height:"500"})))}}]),t}(h.a.Component),E=document.getElementById("root");m.a.render(h.a.createElement(y,null),E)},286:function(e,t,a){},294:function(e,t){},295:function(e,t){},303:function(e,t){},306:function(e,t){},307:function(e,t){},308:function(e,t){}},[[263,2,1]]]);
//# sourceMappingURL=main.4a76f4e3.chunk.js.map